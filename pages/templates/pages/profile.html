{% extends 'pages/base.html' %}

{% block content %}

<div class="row">
  {% include 'pages/partials/_sidebar.html' %}
  <div class="col-md-9 col-sm-12">
  {% if request.user.profile.id == profile.id %}
    <div class="float-right">
      <a href="{% url 'pages:edit' %}" class="btn btn-info">Edit profile</a>
    </div>
    {% elif request.user.is_authenticated %}
      {% if button_friend_text == 'not_friend_yet' %}
        <div class="float-right">
          <a href="{% url 'pages:send_request' profile.id %}" class="btn btn-info">Add friend</a>
        </div>
      {% elif button_friend_text == 'request_sent'%}
        <div class="float-right">
          <a href="{% url 'pages:cancel_request' profile.id %}" class="btn btn-warning">Cancel request</a>
        </div>
      {% endif %}
    {% endif %}
    <h3>{{profile.user}}</h3>
    <div class="my-4">
        <h6>{{profile.first}} {{profile.last}} | {{profile.user.email}}</h6>
        <h6>Speaks: {{profile.speaks}}</h6>
        <h6>Learns: {{profile.learns}}</h6>
    </div>
    {% if friends %}
      <div class="table-responsive">
        <table class="table">
          <caption>My list of PenPals:</caption>
          <thead>
            <tr>
              <th>Profile link:</th>
              <th>Email:</th>
            </tr>
          </thead>
            <tbody>
              {% for friend_profile in friends %}
                <tr>
                  <td><a href="{% url 'pages:profile' friend_profile.id %}">{{friend_profile}}</a></td>
                  <td>{{friend_profile.user.email}}</td>
                </tr>
              {% endfor %}
            </tbody>
        </table>
      </div>
    {% endif %}
    {% if request.user.profile.id == profile.id and received_requests %}
      <div class="table-responsive">
        <table class="table">
          <caption>Received friend requests:</caption>
            <tbody>
              {% for request_received in received_requests %}
                <tr>
                  <td><a href="{% url 'pages:profile' request_received.from_profile.id %}" class="btn text-primary">{{request_received.from_profile}} sent you friend request</a></td>
                  <td><a href="{% url 'pages:accept_request' request_received.from_profile.id %}" class="btn btn-primary">Accept request</a></td>
                  <td><a href="{% url 'pages:delete_request' request_received.from_profile.id %}" class="btn btn-danger">Cancel request</a></td>
                </tr>
              {% endfor %}
            </tbody>
        </table>
      </div>
    {% endif %}
    {% if outgoing_requests %}
      <div class="table-responsive">
        <table class="table">
          <caption>Outgoing friend requests:</caption>
            <tbody>
              {% for request_outgoing in outgoing_requests %}
                <tr>
                  <td><a href="{% url 'pages:profile' request_outgoing.to_profile.id %}" class="btn text-primary">{{request_outgoing.to_profile}}</a></td>
                  <td><a href="{% url 'pages:drop_request' request_outgoing.to_profile.id %}" class="btn btn-danger">Cancel request</a></td>
                </tr>
              {% endfor %}
            </tbody>
        </table>
      </div>
    {% endif %}
  </div>
</div>

{% endblock content %}
